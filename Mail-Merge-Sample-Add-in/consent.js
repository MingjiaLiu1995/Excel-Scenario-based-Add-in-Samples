Office.onReady((function(){let e=new URLSearchParams(location.search).get("data");null!=e?localStorage.setItem("userClientId",e):e=localStorage.getItem("userClientId");const t=location.href.substring(0,location.href.lastIndexOf("/"))+"/consent.html",o=new msal.PublicClientApplication({auth:{clientId:e,authority:"https://login.microsoftonline.com/common",redirectUri:t},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});o.handleRedirectPromise().then((e=>{e?Office.context.ui.messageParent(JSON.stringify({status:"success",result:e.accessToken})):o.loginRedirect({scopes:["mail.send"]})})).catch((e=>{Office.context.ui.messageParent(JSON.stringify({status:"failure",result:{errorCode:e.errorCode,errorMessage:e.errorMessage,stack:e.stack}}))}))}));